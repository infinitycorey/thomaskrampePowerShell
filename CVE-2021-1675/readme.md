Author: Thomas Krampe
Copyright: 2021 by Thomas Krampe
Keywords: CVE-2021-1675,PowerShell,PrintNightmare 


# CVE-2021-1675 aka Print Nightmare Workaround
Just provide a text file with all your servers and run this script to prevent SYSTEM for adding malicious DLL's in your spool\drivers directory.

Run 
`TK_PrintNightMare -mode secure -Serverlist "C:\PathToYour\serverlist.txt"` 

to secure your Print Spooler, or

`TK_PrintNightMare -mode unsecure -Serverlist "C:\PathToYour\serverlist.txt"` 

to change it back to normal/unsecure

![Folder Properties](./FolderProperties.png)

![Running Script](./RunningScript.png)

That's it, but keep in mind that's only a workaround until a patch is available - whatch this space https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-1675.

